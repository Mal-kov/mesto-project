(()=>{"use strict";var e={937:(e,t,o)=>{e.exports=o.p+"bbe2a6eafac19c3d031c.svg"}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var c=t[n]={exports:{}};return e[n](c,c.exports,o),c.exports}o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.p="";var n={};(()=>{o.d(n,{ZU:()=>V,zS:()=>A,AV:()=>U,im:()=>G,wL:()=>M,vi:()=>x,CV:()=>P,cp:()=>j,QN:()=>L});var e={baseUrl:"https://mesto.nomoreparties.co/v1/plus-cohort7",headers:{authorization:"f413e3da-678f-4c47-9635-459b1d831638","Content-Type":"application/json"}},t=function(e){j.setAttribute("disabled",!0),j.classList.add(e),M.setAttribute("disabled",!0),M.classList.add(e)},r=function(e){e.classList.add("popup_opened"),document.addEventListener("keydown",a);var o=e.classList.contains("popup_type_place"),n=e.classList.contains("popup__form_type_profile");o?t("popup__btn-save_inactive"):n&&G()},c=function(e){e.classList.remove("popup_opened"),document.removeEventListener("keydown",a)},l=function(e){document.addEventListener("click",(function(t){t.target.classList.contains("popup")&&(t.preventDefault(),c(e))}))},a=function(e){if(e.keyCode==V){var t=document.querySelector(".popup_opened");c(t)}},u=function(e){return e.ok?e.json():Promise.reject("Ошибка - ".concat(e.status))},i=document.querySelector(".elements__list"),s=document.querySelector("#popup-place-name"),p=document.querySelector("#popup-place-link"),d=document.querySelector(".popup_delete-card"),_=d.querySelector(".popup__btn-close"),f=d.querySelector(".popup__btn-save"),v=function(e){var t=m(e);i.prepend(t)},m=function(t){console.log(t);var o=0,n=document.querySelector("#place-template").content.querySelector(".elements__item").cloneNode(!0);t.owner._id===L?n.querySelector(".elements__btn-trash").addEventListener("click",(function(e){r(d),f.addEventListener("click",y(t,n))})):n.querySelector(".elements__btn-trash").remove(),n.querySelector(".elements__title").textContent=t.name,n.querySelector(".elements__like-count").textContent=t.likes.length;var c=n.querySelector(".elements__img");return c.setAttribute("src",t.link),c.setAttribute("alt",t.name),n.querySelector(".elements__img").addEventListener("click",(function(e){!function(e,t){r(x),A.setAttribute("src",t),A.setAttribute("alt",e),U.textContent=e}(e.target.alt,e.target.currentSrc)})),n.querySelector(".elements__btn-heart").addEventListener("click",(function(r){var c;r.target.classList.toggle("elements__btn-heart_active"),++o%2?(console.log("Поставил лайк"),(c=t._id,fetch("".concat(e.baseUrl,"/cards/likes/").concat(c),{method:"PUT",headers:e.headers}).then(u)).then((function(e){n.querySelector(".elements__like-count").textContent=e.likes.length}))):(console.log("Снял лайк"),function(t){return fetch("".concat(e.baseUrl,"/cards/likes/").concat(t),{method:"DELETE",headers:e.headers}).then(u)}(t._id).then((function(e){n.querySelector(".elements__like-count").textContent=e.likes.length})))})),n},y=function(t,o){var n;console.log(t._id),console.log("есть клик на кнопке подтверждения удаления карты"),o.remove(),(n=t._id,fetch("".concat(e.baseUrl,"/cards/").concat(n),{method:"DELETE",headers:e.headers}).then(u)).then((function(e){console.log("Карточка успешно удалена",e),c(d)})).catch((function(e){console.log("Ошибка удаления карты"),console.log(e)})).finally((function(){}))},h=o(937),S=document.querySelector(".header__logo"),b=document.querySelector(".profile__image"),g=document.querySelector(".profile__name"),q=document.querySelector(".profile__skills"),L="",E=document.querySelector(".profile__btn-edit"),k=document.querySelector(".profile__btn-add"),C=document.querySelector(".profile__image-edit"),x=document.querySelector(".popup_type_image"),A=x.querySelector(".popup__image-big"),U=x.querySelector(".popup__image-title"),T=x.querySelector(".popup__btn-close"),D=document.querySelector(".popup_type_profile"),O=D.querySelector(".popup__btn-close"),P=document.querySelector(".popup_type_place"),B=P.querySelector(".popup__btn-close"),j=P.querySelector(".popup__btn-save"),w=P.querySelector(".popup__form_type_place"),N=D.querySelector(".popup__form_type_profile"),F=N.querySelector("#popup-profile-name"),I=N.querySelector("#popup-profile-skills"),J=document.querySelector(".popup_type_avatar"),z=J.querySelector(".popup__btn-close"),H=J.querySelector("#popup-avatar-link"),M=J.querySelector(".popup__btn-save"),V="27",Q=document.querySelector(".profile__name"),Z=document.querySelector(".profile__skills");C.addEventListener("click",(function(){r(J)})),z.addEventListener("click",(function(){c(J)})),E.addEventListener("click",(function(){r(D)})),O.addEventListener("click",(function(){c(D)})),k.addEventListener("click",(function(){r(P)})),B.addEventListener("click",(function(){c(P)})),T.addEventListener("click",(function(){c(x)})),_.addEventListener("click",(function(){c(d)})),S.src=h,J.addEventListener("submit",(function(t){var o;t.preventDefault(),(o=H.value,fetch("".concat(e.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:e.headers,body:JSON.stringify({avatar:o})}).then(u)).then((function(e){console.log(e),b.src=e.avatar,H.value="",c(J)})).catch((function(e){console.log("Ошибка изменения аватара"),console.log(e)})).finally((function(){}))})),N.addEventListener("submit",(function(t){t.preventDefault();var o=F.value,n=I.value;(function(t,o){return fetch("".concat(e.baseUrl,"/users/me"),{method:"PATCH",headers:e.headers,body:JSON.stringify({name:t,about:o})}).then(u)})(o,n).then((function(e){Q.textContent=o,Z.textContent=n,console.log("Загрузка Имя: ".concat(o," Профиль ").concat(n," ")),console.log("Загрузка изменений имени - выполнена"),console.log(e),c(D)})).catch((function(e){console.log("Ошибка загрузки изменений "),console.log(e)})).finally((function(){}))})),w.addEventListener("submit",(function(t){var o,n;t.preventDefault(),(o=s.value,n=p.value,fetch("".concat(e.baseUrl,"/cards"),{method:"POST",headers:e.headers,body:JSON.stringify({name:o,link:n})}).then(u)).then((function(e){console.log("Новая карточка создана"),console.log(e),v(e),c(P),s.value="",p.value=""})).catch((function(e){console.log("Ошибка создания новой карточки"),console.log(e)})).finally((function(){}))}));var G=function(){fetch("".concat(e.baseUrl,"/cards"),{headers:e.headers}).then(u).then((function(e){e.forEach((function(e){v(e)}))})).catch((function(e){console.log("Ошибка при отрисовке карт",e)})).finally((function(){}))};!function(e){var o=document.querySelectorAll(e.formSelector),n=Array.from(o);t(e.inactiveButtonClass);var r=function(e){e.preventDefault()};n.forEach((function(t){t.addEventListener("submit",r),function(e,t){var o=e.querySelectorAll(t.inputSelector),n=Array.from(o),r=e.querySelector(t.submitButtonSelector);n.forEach((function(e){e.addEventListener("input",(function(){!function(e,t){e.validity.valid?function(e,t){var o=e.closest(t.popupFormSection).querySelector(t.popupInputTextError);o.textContent="",o.classList.remove(t.inputErrorClass),e.classList.remove(t.errorClass)}(e,t):function(e,t,o){var n=e.closest(o.popupFormSection).querySelector(o.popupInputTextError);n.textContent=t,n.classList.add(o.inputErrorClass),e.classList.add(o.errorClass)}(e,e.validationMessage,t)}(e,t),function(e,t,o){var n=e.some((function(e){return!e.validity.valid})),r=e.some((function(e){return e.validity.valueMissing}));console.log(r),n?(t.classList.add(o.inactiveButtonClass),t.setAttribute("disabled",!0)):(t.classList.remove(o.inactiveButtonClass),t.removeAttribute("disabled"))}(n,r,t)}))}))}(t,e)}))}({formSelector:".popup__form",inputSelector:".popup__input-text",submitButtonSelector:".popup__btn-save",popupFormSection:".popup__form-section",popupInputTextError:".popup__input-text-error",inactiveButtonClass:"popup__btn-save_inactive",inputErrorClass:"popup__input-text-error_active",errorClass:"popup__input-text_err"}),l(P),l(D),l(x),l(d),l(J),fetch("".concat(e.baseUrl,"/users/me"),{headers:e.headers}).then(u).then((function(e){b.src=e.avatar,g.textContent=e.name,q.textContent=e.about,L=e._id,F.value=e.name,I.value=e.about,console.log("Загрузка информации о пользователе - выполнена"),console.log(e)})).catch((function(e){console.log("Ошибка загрузки информации о пользователе"),console.log(e)})).finally((function(){})),G()})()})();