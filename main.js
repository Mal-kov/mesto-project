(()=>{"use strict";var e={937:(e,t,o)=>{e.exports=o.p+"bbe2a6eafac19c3d031c.svg"}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var c=t[n]={exports:{}};return e[n](c,c.exports,o),c.exports}o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.p="";var n={};(()=>{o.d(n,{ZU:()=>M,zS:()=>x,AV:()=>A,im:()=>Z,wL:()=>H,vi:()=>C,CV:()=>j,cp:()=>O,QN:()=>q});var e={baseUrl:"https://mesto.nomoreparties.co/v1/plus-cohort7",headers:{authorization:"f413e3da-678f-4c47-9635-459b1d831638","Content-Type":"application/json"}},t=function(e){O.setAttribute("disabled",!0),O.classList.add(e),H.setAttribute("disabled",!0),H.classList.add(e)},r=function(e){e.classList.add("popup_opened"),document.addEventListener("keydown",u);var o=e.classList.contains("popup_type_place"),n=e.classList.contains("popup__form_type_profile");o?t("popup__btn-save_inactive"):n&&Z()},c=function(e){e.classList.remove("popup_opened"),document.removeEventListener("keydown",u)},l=function(e){document.addEventListener("click",(function(t){t.target.classList.contains("popup")&&(t.preventDefault(),c(e))}))},u=function(e){if(e.keyCode==M){var t=document.querySelector(".popup_opened");c(t)}},a=function(e){return e.ok?e.json():Promise.reject("Ошибка - ".concat(e.status))},s=document.querySelector(".elements__list"),i=document.querySelector("#popup-place-name"),p=document.querySelector("#popup-place-link"),d=document.querySelector(".popup_delete-card"),_=d.querySelector(".popup__btn-close"),f=d.querySelector(".popup__btn-save"),m=function(e){var t=v(e);s.prepend(t)},v=function(t){console.log(t);var o=0,n=document.querySelector("#place-template").content.querySelector(".elements__item").cloneNode(!0);t.owner._id===q?n.querySelector(".elements__btn-trash").addEventListener("click",(function(o){r(d),f.addEventListener("click",(function(o){var n;console.log("есть клик на кнопке подтверждения"),console.log(o.target),(n=t._id,fetch("".concat(e.baseUrl,"/cards/").concat(n),{method:"DELETE",headers:e.headers}).then((function(e){if(!e.ok)return Promise.reject("Ошибка - ".concat(responce.status))}))).then((function(e){console.log(e),c(d)})).catch((function(e){console.log("Ошибка удаления карты"),console.log(e)}))}))})):n.querySelector(".elements__btn-trash").remove(),n.querySelector(".elements__title").textContent=t.name,n.querySelector(".elements__like-count").textContent=t.likes.length;var l=n.querySelector(".elements__img");return l.setAttribute("src",t.link),l.setAttribute("alt",t.name),n.querySelector(".elements__img").addEventListener("click",(function(e){!function(e,t){r(C),x.setAttribute("src",t),x.setAttribute("alt",e),A.textContent=e}(e.target.alt,e.target.currentSrc)})),n.querySelector(".elements__btn-heart").addEventListener("click",(function(r){var c;r.target.classList.toggle("elements__btn-heart_active"),++o%2?(console.log("Поставил лайк"),console.log(t._id),(c=t._id,fetch("".concat(e.baseUrl,"/cards/likes/").concat(c),{method:"PUT",headers:e.headers}).then(a)).then((function(e){n.querySelector(".elements__like-count").textContent=e.likes.length}))):(console.log("Снял лайк"),function(t){return fetch("".concat(e.baseUrl,"/cards/likes/").concat(t),{method:"DELETE",headers:e.headers}).then((function(e){if(!e.ok)return Promise.reject("Ошибка - ".concat(responce.status))}))}(t._id).then((function(e){n.querySelector(".elements__like-count").textContent=e.likes.length})))})),n},y=o(937),h=document.querySelector(".header__logo"),S=document.querySelector(".profile__image"),b=document.querySelector(".profile__name"),g=document.querySelector(".profile__skills"),q="",L=document.querySelector(".profile__btn-edit"),E=document.querySelector(".profile__btn-add"),k=document.querySelector(".profile__image-edit"),C=document.querySelector(".popup_type_image"),x=C.querySelector(".popup__image-big"),A=C.querySelector(".popup__image-title"),U=C.querySelector(".popup__btn-close"),T=document.querySelector(".popup_type_profile"),P=T.querySelector(".popup__btn-close"),j=document.querySelector(".popup_type_place"),D=j.querySelector(".popup__btn-close"),O=j.querySelector(".popup__btn-save"),B=j.querySelector(".popup__form_type_place"),w=T.querySelector(".popup__form_type_profile"),N=w.querySelector("#popup-profile-name"),F=w.querySelector("#popup-profile-skills"),I=document.querySelector(".popup_type_avatar"),J=I.querySelector(".popup__btn-close"),z=I.querySelector("#popup-avatar-link"),H=I.querySelector(".popup__btn-save"),M="27",V=document.querySelector(".profile__name"),Q=document.querySelector(".profile__skills");k.addEventListener("click",(function(){r(I)})),J.addEventListener("click",(function(){c(I)})),L.addEventListener("click",(function(){r(T)})),P.addEventListener("click",(function(){c(T)})),E.addEventListener("click",(function(){r(j)})),D.addEventListener("click",(function(){c(j)})),U.addEventListener("click",(function(){c(C)})),_.addEventListener("click",(function(){c(d)})),h.src=y,I.addEventListener("submit",(function(t){var o;t.preventDefault(),(o=z.value,fetch("".concat(e.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:e.headers,body:JSON.stringify({avatar:o})}).then(a)).then((function(e){console.log(e),S.src=e.avatar})).catch((function(e){console.log("Ошибка изменения аватара"),console.log(e)})).finally((function(){z.value="",c(I)}))})),w.addEventListener("submit",(function(t){t.preventDefault();var o=N.value,n=F.value;(function(t,o){return fetch("".concat(e.baseUrl,"/users/me"),{method:"PATCH",headers:e.headers,body:JSON.stringify({name:t,about:o})}).then(a)})(o,n).then((function(e){V.textContent=o,Q.textContent=n,console.log("Загрузка Имя: ".concat(o," Профиль ").concat(n," ")),console.log("Загрузка изменений имени - выполнена"),console.log(e)})).catch((function(e){console.log("Ошибка загрузки изменений "),console.log(e)})),c(T)})),B.addEventListener("submit",(function(o){var n,r;o.preventDefault(),(n=i.value,r=p.value,fetch("".concat(e.baseUrl,"/cards"),{method:"POST",headers:e.headers,body:JSON.stringify({name:n,link:r})}).then(a)).then((function(e){console.log("Новая карточка создана"),console.log(e),m(e)})).catch((function(e){console.log("Ошибка создания новой карточки"),console.log(e)})).finally((function(){i.value="",p.value="",c(j),t(j)}))}));var Z=function(){fetch("".concat(e.baseUrl,"/cards"),{headers:e.headers}).then(a).then((function(e){e.forEach((function(e){m(e)}))})).catch((function(e){console.log("Ошибка при отрисовке карт",e)}))};!function(e){var o=document.querySelectorAll(e.formSelector),n=Array.from(o);t(e.inactiveButtonClass);var r=function(e){e.preventDefault()};n.forEach((function(t){t.addEventListener("submit",r),function(e,t){var o=e.querySelectorAll(t.inputSelector),n=Array.from(o),r=e.querySelector(t.submitButtonSelector);n.forEach((function(e){e.addEventListener("input",(function(){!function(e,t){e.validity.valid?function(e,t){var o=e.closest(t.popupFormSection).querySelector(t.popupInputTextError);o.textContent="",o.classList.remove(t.inputErrorClass),e.classList.remove(t.errorClass)}(e,t):function(e,t,o){var n=e.closest(o.popupFormSection).querySelector(o.popupInputTextError);n.textContent=t,n.classList.add(o.inputErrorClass),e.classList.add(o.errorClass)}(e,e.validationMessage,t)}(e,t),function(e,t,o){var n=e.some((function(e){return!e.validity.valid})),r=e.some((function(e){return e.validity.valueMissing}));console.log(r),n?(t.classList.add(o.inactiveButtonClass),t.setAttribute("disabled",!0)):(t.classList.remove(o.inactiveButtonClass),t.removeAttribute("disabled"))}(n,r,t)}))}))}(t,e)}))}({formSelector:".popup__form",inputSelector:".popup__input-text",submitButtonSelector:".popup__btn-save",popupFormSection:".popup__form-section",popupInputTextError:".popup__input-text-error",inactiveButtonClass:"popup__btn-save_inactive",inputErrorClass:"popup__input-text-error_active",errorClass:"popup__input-text_err"}),l(j),l(T),l(C),l(d),l(I),fetch("".concat(e.baseUrl,"/users/me"),{headers:e.headers}).then(a).then((function(e){S.src=e.avatar,b.textContent=e.name,g.textContent=e.about,q=e._id,N.value=e.name,F.value=e.about,console.log("Загрузка информации о пользователе - выполнена"),console.log(e)})).catch((function(e){console.log("Ошибка загрузки информации о пользователе"),console.log(e)})),Z()})()})();